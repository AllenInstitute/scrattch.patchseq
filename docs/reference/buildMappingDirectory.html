<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Starting from an anndata object this function builds the minimum files required for patch-seq shiny — buildMappingDirectory • scrattch.patchseq</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Starting from an anndata object this function builds the minimum files required for patch-seq shiny — buildMappingDirectory"><meta property="og:description" content="Starting from an anndata object this function builds the minimum files required for patch-seq shiny"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scrattch.patchseq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/go_to_examples.html">Go to examples</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Starting from an anndata object this function builds the minimum files required for patch-seq shiny</h1>

    <div class="hidden name"><code>buildMappingDirectory.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Starting from an anndata object this function builds the minimum files required for patch-seq shiny</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">buildMappingDirectory</span><span class="op">(</span></span>
<span>  <span class="va">AIT.anndata</span>,</span>
<span>  <span class="va">mappingFolder</span>,</span>
<span>  <span class="va">query.data</span>,</span>
<span>  <span class="va">query.metadata</span>,</span>
<span>  <span class="va">query.mapping</span>,</span>
<span>  doPatchseqQC <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  metadata_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min.confidence <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  return.metrics <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-ait-anndata">AIT.anndata<a class="anchor" aria-label="anchor" href="#arg-ait-anndata"></a></dt>
<dd><p>A reference taxonomy object.</p></dd>


<dt id="arg-mappingfolder">mappingFolder<a class="anchor" aria-label="anchor" href="#arg-mappingfolder"></a></dt>
<dd><p>The location to save output files for patch-seq (or other query data) results, e.g. "/allen/programs/celltypes/workgroups/rnaseqanalysis/shiny/star/human/human_patchseq_MTG_JAM_TEST/current/"</p></dd>


<dt id="arg-query-data">query.data<a class="anchor" aria-label="anchor" href="#arg-query-data"></a></dt>
<dd><p>A CPM normalized matrix to be annotated.</p></dd>


<dt id="arg-query-metadata">query.metadata<a class="anchor" aria-label="anchor" href="#arg-query-metadata"></a></dt>
<dd><p>A data frame of metadata for the query data.</p></dd>


<dt id="arg-query-mapping">query.mapping<a class="anchor" aria-label="anchor" href="#arg-query-mapping"></a></dt>
<dd><p>Mapping results from <code>taxonomy_mapping()</code>, must be an mappingClass S4 object. If provided row names must match column names in query.data.</p></dd>


<dt id="arg-dopatchseqqc">doPatchseqQC<a class="anchor" aria-label="anchor" href="#arg-dopatchseqqc"></a></dt>
<dd><p>Boolean indicating whether patch-seq QC metrics should be calculated (default) or not.</p></dd>


<dt id="arg-metadata-names">metadata_names<a class="anchor" aria-label="anchor" href="#arg-metadata-names"></a></dt>
<dd><p>An optional named character vector where the vector NAMES correspond to columns in the metadata matrix and the vector VALUES correspond to how these metadata should be displayed in Shiny. This is used for writing the desc.feather file later.</p></dd>


<dt id="arg-min-confidence">min.confidence<a class="anchor" aria-label="anchor" href="#arg-min-confidence"></a></dt>
<dd><p>Probability below which a cell cannot be assigned to a cell type (default 0.7).  In other words, if no cell types have probabilities greater than resolution.index, then the assigned cluster will be an internal node of the dendrogram.</p></dd>


<dt id="arg-return-metrics">return.metrics<a class="anchor" aria-label="anchor" href="#arg-return-metrics"></a></dt>
<dd><p>If TRUE (default=FALSE) will return an updated query.metadata data frame with additional metrics calculated as part of this function. Otherwise, these values are available in 'anno.feather'.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Should detail logging be printed to the screen?</p>
<p>This function writes files to the mappingFolder directory for visualization with molgen-shiny tools
— anno.feather - query metadata
— data.feather - query data
— dend.RData   - dendrogram (copied from reference)
— desc.feather - table indicating which anno columns to share
— memb.feather - tree mapping of each query cell to each tree node (not just the best matching type like in treeMap)
— tsne.feather - low dimensional coordinates for data
— tsne_desc.feather - table indicating which low-D representations to share</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Inkar Kapen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

